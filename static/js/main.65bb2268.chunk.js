(this["webpackJsonpische-pandemic-archive"]=this["webpackJsonpische-pandemic-archive"]||[]).push([[0],{115:function(e,t,r){},116:function(e,t,r){},117:function(e,t,r){},126:function(e,t,r){},189:function(e,t){},190:function(e,t){},266:function(e,t,r){},270:function(e,t,r){"use strict";r.r(t);var s=r(0),i=r.n(s),a=r(107),c=r.n(a),n=(r(115),r(13)),l=r(14),o=r(16),u=r(15),d=(r(116),r(117),r(275)),h=r(272),j=r(273),m=r(274),p=r(276),f=r(271),b=r(29),v=r(1),O=function(e){Object(o.a)(r,e);var t=Object(u.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"render",value:function(){return Object(v.jsx)(b.c,{to:"/resource/"+this.props.item.id,children:Object(v.jsxs)(p.a,{style:{marginBottom:"10px",minHeight:"280px"},children:[this.props.item.fields.Attachments&&this.props.item.fields.Attachments.length>0&&Object(v.jsx)(p.a.Img,{variant:"top",src:this.props.item.fields.Attachments[0].url}),Object(v.jsxs)(p.a.Body,{children:[Object(v.jsx)(p.a.Title,{children:this.props.item.fields["Title ID"]}),Object(v.jsx)(p.a.Text,{}),this.props.item.fields.Type_name&&this.props.item.fields.Type_name.map((function(e){return Object(v.jsx)(f.a,{variant:"info",children:e})}))]})]})})}}]),r}(s.Component),y=function(e){var t=e.archiveItems;return Object(v.jsx)(h.a,{children:Object(v.jsx)(j.a,{xs:2,md:3,lg:4,children:t.map((function(e){return Object(v.jsx)(m.a,{children:Object(v.jsx)(O,{item:e})},e.id)}))})})},x=r(9),g=r(109),w=function(e){var t=e.archiveItems,r=i.a.useMemo((function(){return t.map((function(e){return e.fields}))}),[]),s=i.a.useMemo((function(){return[{Header:"Pandemics",accessor:"Pandemic"},{Header:"Title",accessor:"Title ID"},{Header:"Type",accessor:"Type"},{Header:"Themes",accessor:"Themes"},{Header:"Tags",accessor:"Tags"},{Header:"Languages",accessor:"Language"},{Header:"Contributor",accessor:"Contributor"}]}),[]),a=Object(g.useTable)({columns:s,data:r}),c=a.getTableProps,n=a.getTableBodyProps,l=a.headerGroups,o=a.rows,u=a.prepareRow;return Object(v.jsxs)("table",Object(x.a)(Object(x.a)({},c()),{},{children:[Object(v.jsx)("thead",{children:l.map((function(e){return Object(v.jsx)("tr",Object(x.a)(Object(x.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(v.jsx)("th",Object(x.a)(Object(x.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}))}))}),Object(v.jsx)("tbody",Object(x.a)(Object(x.a)({},n()),{},{children:o.map((function(e){return u(e),Object(v.jsx)("tr",Object(x.a)(Object(x.a)({},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(v.jsx)("td",Object(x.a)(Object(x.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))},k=function(e){e.archiveItems;return Object(v.jsx)("div",{children:"Map"})},T=(r(126),r(40)),N=r(21),C=function(e){var t=Object(N.c)(e.filterName,N.a),r=Object(T.a)(t,2),s=r[0],i=r[1],a=s||[];return Object(v.jsx)("div",{className:"filter-list",children:e.filterItems.map((function(t){var r=t.fields[e.labelBy],s=a.includes(r);return Object(v.jsxs)("label",{className:"filter-list-item ".concat(s?"checked":" "),children:[Object(v.jsx)("div",{className:"circle-checkbox"}),Object(v.jsx)("input",{type:"checkbox",checked:s,value:r,onChange:function(){return e=r,a.includes(e)?a.splice(a.indexOf(e),1):a.push(e),void i(a);var e}}),r," (",t.fields.Count,")"]})}))})},I=r.p+"static/media/arrow.9282adbf.svg",P=function(e){var t=e.open,r=e.width,i=e.children,a=e.title,c=e.onClose,n=s.useRef();!function(e,t){var r=function(r){!e.current||e.current.contains(r.target)||e.current.parentNode.contains(r.target)||t()};s.useEffect((function(){return document.addEventListener("click",r),function(){document.removeEventListener("click",r)}}))}(n,(function(){t&&c()}));var l=t?"".concat(r,"px"):"0px";return Object(v.jsx)(s.Fragment,{children:Object(v.jsxs)("div",{ref:n,className:"secondary-sidebar",style:{left:l,width:"".concat(r,"px")},children:[Object(v.jsxs)("div",{className:"secondary-sidebar-header",children:[Object(v.jsx)("div",{className:"arrow-icon reverse",style:{backgroundImage:"url(".concat(I,")")},onClick:function(){return c()}}),Object(v.jsx)("div",{className:"filter-title",children:a})]}),Object(v.jsx)("div",{className:"secondary-sidebar-content",children:i})]})})},S=[{key:"pandemics",label:"Pandemics"},{key:"themes",label:"Themes"},{key:"tags",label:"Tags"},{key:"resource_type",label:"Types"},{key:"languages",label:"Languages"},{key:"countries",label:"Countries"},{key:"cities",label:"Cities"},{key:"dates",label:"Dates"}],F=function(e){Object(o.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(n.a)(this,r);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).state={showSideMenu:!1,currentFilterPanel:null},e}return Object(l.a)(r,[{key:"setShowSideMenu",value:function(e){this.setState({showSideMenu:e})}},{key:"setFilterPanel",value:function(e){this.setState({currentFilterPanel:e}),e&&this.setShowSideMenu(!0)}},{key:"currentFilterContent",value:function(){switch(this.state.currentFilterPanel){case"pandemics":return Object(v.jsx)(C,{blockTitle:"Pandemics",filterName:"Pandemic",labelBy:"Name",filterItems:this.props.filters.pandemics});case"themes":return Object(v.jsx)(C,{blockTitle:"Themes",filterName:"Themes",labelBy:"Theme",filterItems:this.props.filters.themes});case"resource_type":return Object(v.jsx)(C,{blockTitle:"Resource Type",filterName:"Type",labelBy:"Type",filterItems:this.props.filters.types});case"tags":return Object(v.jsx)(C,{blockTitle:"Tags",filterName:"Tags",labelBy:"Tag",filterItems:this.props.filters.tags});case"languages":return Object(v.jsx)(C,{blockTitle:"Languages",filterName:"Language",labelBy:"Language",filterItems:this.props.filters.languages});case"countries":return Object(v.jsx)(C,{blockTitle:"Countries",filterName:"Country",labelBy:"Country",filterItems:this.props.filters.countries});case"cities":return Object(v.jsx)(C,{blockTitle:"Cities",filterName:"City",labelBy:"City",filterItems:this.props.filters.cities});default:return Object(v.jsx)("div",{})}}},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"sidebar-container",children:[Object(v.jsxs)("div",{className:"primary-sidebar",children:[Object(v.jsx)("div",{className:"sidebar-title",children:"Filters"}),S.map((function(t){return Object(v.jsxs)("div",{className:"filter-type ".concat(e.state.currentFilterPanel===t.key?"active":" "),onClick:function(){return e.setFilterPanel(t.key)},children:[t.label,Object(v.jsx)("div",{className:"arrow-icon",style:{backgroundImage:"url(".concat(I,")")}})]})}))]}),Object(v.jsx)(P,{open:this.state.showSideMenu,width:"250",title:this.state.currentFilterPanel?S.find((function(t){return t.key===e.state.currentFilterPanel})).label:"",onClose:function(){e.setShowSideMenu(!1),e.setFilterPanel(!1)},children:this.currentFilterContent()})]})}}]),r}(s.Component),L=function(e){var t=e.filterKey,r=Object(N.c)(t,N.a),s=Object(T.a)(r,2),i=s[0],a=s[1],c=i||[];return c.map((function(e){return Object(v.jsxs)("div",{className:"filter-recap-item",onClick:function(){return function(e){c.includes(e)&&c.splice(c.indexOf(e),1),a(c)}(e)},children:[e," ",Object(v.jsx)("span",{children:"X"})]})}))},B=r(24),R=r.n(B),M=function(e){Object(o.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(n.a)(this,r);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).state={archiveItems:[],loading:!1,currentViewType:"grid"},e}return Object(l.a)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e){JSON.stringify(e.params)!==JSON.stringify(this.props.params)&&this.fetchData()}},{key:"setCurrentViewType",value:function(e){this.setState({currentViewType:e})}},{key:"fetchData",value:function(){var e=this,t=this;t.setState({loading:!0});var r=new R.a({apiKey:"key8p1ipk3FEGppuA"}).base("appyRkLfkVtG84rMU"),s=[];this.props.params&&Object.keys(this.props.params).forEach((function(t){var r=Array.isArray(e.props.params[t])?e.props.params[t]:[e.props.params[t]];s.push("OR("+r.map((function(e){return'FIND("'+e+'",{'+t+"})"})).join(", ")+")")}));var i=s.length>0?"AND("+s.join(", ")+")":"";r("Data Sample").select({view:"Grid view",filterByFormula:i}).firstPage((function(e,r){e?console.error(e):t.setState({archiveItems:r,loading:!1})}))}},{key:"renderParamsRecap",value:function(){return Object.keys(this.props.params).map((function(e){return Object(v.jsx)(L,{filterKey:e})}))}},{key:"renderCurrentViewType",value:function(){switch(this.state.currentViewType){case"grid":return Object(v.jsx)(y,{archiveItems:this.state.archiveItems});case"list":return Object(v.jsx)(w,{archiveItems:this.state.archiveItems});case"map":return Object(v.jsx)(k,{archiveItems:this.state.archiveItems});default:return Object(v.jsx)("div",{})}}},{key:"render",value:function(){var e=this;return Object(v.jsxs)("div",{className:"home-view",children:[Object(v.jsx)("div",{className:"sidebar",children:Object(v.jsx)(F,{filters:this.props.filters})}),Object(v.jsxs)("div",{className:"main-content",children:[Object(v.jsxs)("div",{className:"content-top-bar",children:[Object(v.jsxs)("div",{className:"results-count",children:["Results: ",this.state.archiveItems.length]}),Object(v.jsxs)("div",{className:"results-view-type",children:[Object(v.jsx)("div",{className:"view-type grid ".concat("grid"==this.state.currentViewType?"active":""),onClick:function(){return e.setCurrentViewType("grid")},children:"G"}),Object(v.jsx)("div",{className:"view-type list ".concat("list"==this.state.currentViewType?"active":""),onClick:function(){return e.setCurrentViewType("list")},children:"L"}),Object(v.jsx)("div",{className:"view-type map ".concat("map"==this.state.currentViewType?"active":""),onClick:function(){return e.setCurrentViewType("map")},children:"M"})]}),Object(v.jsx)("div",{className:"results-seach",children:Object(v.jsx)("input",{type:"text"})})]}),Object(v.jsx)("div",{className:"content-filters-summary",children:this.props.params&&this.renderParamsRecap()}),this.state.loading?Object(v.jsxs)("div",{className:"loading",children:[Object(v.jsx)(d.a,{animation:"border"}),"Loading resources"]}):this.renderCurrentViewType()]})]})}}]),r}(s.Component);r(266);var A=function(e){Object(o.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(n.a)(this,r);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).state={resource:{}},e}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=this;new R.a({apiKey:"key8p1ipk3FEGppuA"}).base("appyRkLfkVtG84rMU")("Data Sample").find(this.props.resourceId,(function(t,r){t?console.error(t):e.setState({resource:r})}))}},{key:"generateEmbedCode",value:function(){var e,t,r=Object(v.jsx)("div",{});try{e=new URL(this.state.resource.fields.URL)}catch(n){r=Object(v.jsx)("div",{children:"No url is defined"})}if(e)if(e.hostname.includes("youtu")){var s=(t=(t=e.href).replace(/(>|<)/gi,"").split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]?t[2].split(/[^0-9a-z_\-]/i)[0]:t;r=Object(v.jsx)("iframe",{width:"640",height:"360",title:"content",src:"https://www.youtube.com/embed/"+s,frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0})}else if(e.hostname.includes("vimeo")){var i=function(e){var t="",r=e.match(/https:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/);return r&&(t=r[2]),t}(e.href);r=Object(v.jsx)("iframe",{width:"640",height:"360",title:"content",src:"https://player.vimeo.com/video/"+i,frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:!0})}else if(e.hostname.includes("archive.org")){var a=function(e){return e.replace("details","embed")}(e.href);r=Object(v.jsx)("iframe",{width:"640",height:"360",title:"content",src:a,frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:!0})}else if(e.hostname.includes("spotify")){var c=function(e){var t=new URL(e);return t.origin+"/embed/"+t.pathname}(e.href);r=Object(v.jsx)("iframe",{width:"640",height:"360",title:"content",src:c,frameborder:"0",allowtransparency:"true",allow:"encrypted-media"})}else e.hostname.includes("soundcloud")&&(r=Object(v.jsx)("iframe",{width:"100%",height:"300",scrolling:"no",frameborder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url="+encodeURIComponent(e.href)+"&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"}));return r}},{key:"resourceMedia",value:function(){var e=Object(v.jsx)("span",{children:"No item format defined"}),t=this.state.resource.fields.item_format;return"Website"===t||"Image"===t?e=Object(v.jsx)("img",{src:this.state.resource.fields.Attachments[0].url,alt:this.state.resource.fields["Title ID"]}):"Embed"===t&&(e=this.generateEmbedCode()),e}},{key:"resourceInfo",value:function(){var e=this;return Object(v.jsxs)("div",{className:"resource-sideinfo",children:[Object(v.jsxs)("div",{className:"resource-title",children:[this.state.resource.fields["Title ID"],Object(v.jsx)("div",{className:"bookmark"})]}),Object(v.jsx)("div",{className:"resource-desc",children:this.state.resource.fields["Summary (limit 500)"]}),Object(v.jsx)("div",{className:"resource-metadata",children:["Pandemics","Type_name","Themes_name","Tags","Country","City","Language","Credits","Created","Published","Archived","Contributor"].map((function(t){return Object(v.jsxs)("div",{className:"meta-row",children:[Object(v.jsx)("div",{className:"meta-title",children:t}),Object(v.jsx)("div",{className:"meta-value",children:Array.isArray(e.state.resource.fields[t])?e.state.resource.fields[t].join(", "):e.state.resource.fields[t]})]},t)}))}),this.state.resource.fields.URL&&Object(v.jsx)("div",{className:"resource-source",children:Object(v.jsx)("a",{href:this.state.resource.fields.URL,children:"GO TO THE SOURCE"})})]})}},{key:"render",value:function(){return this.state.resource.fields?Object(v.jsxs)("div",{className:"resource-view",children:[Object(v.jsx)("div",{className:"resource-preview",children:this.resourceMedia()}),Object(v.jsx)("div",{className:"resource-sideinfo-container",children:this.resourceInfo()})]}):Object(v.jsxs)("div",{className:"loading",children:[Object(v.jsx)(d.a,{animation:"border"}),"Loading resource"]})}}]),r}(s.Component),G=r(110),D=r.n(G),V=r.p+"static/media/logo.65b2bc4b.svg",_=r(3),E=function(e){Object(o.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(n.a)(this,r);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).state={types:[],pandemics:[],languages:[],tags:[],countries:[],themes:[],cities:[]},e}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=this,t=new R.a({apiKey:"key8p1ipk3FEGppuA"}).base("appyRkLfkVtG84rMU");t("Type list").select({view:"Grid view",filterByFormula:"{Count}>0"}).firstPage((function(t,r){t?console.error(t):e.setState({types:r})})),t("Pandemic list").select({view:"Grid view",filterByFormula:"{Count}>0"}).firstPage((function(t,r){t?console.error(t):e.setState({pandemics:r})})),t("Language list").select({view:"Grid view",filterByFormula:"{Count}>0"}).firstPage((function(t,r){t?console.error(t):e.setState({languages:r})})),t("Tag list").select({view:"Grid view",filterByFormula:"{Count}>0"}).firstPage((function(t,r){t?console.error(t):e.setState({tags:r})})),t("Countries List").select({view:"Grid view",filterByFormula:"{Count}>0"}).firstPage((function(t,r){t?console.error(t):e.setState({countries:r})})),t("Themes list").select({view:"Grid view",filterByFormula:"{Count}>0"}).firstPage((function(t,r){t?console.error(t):e.setState({themes:r})})),t("Cities List").select({view:"Grid view",filterByFormula:"{Count}>0"}).firstPage((function(t,r){t?console.error(t):e.setState({cities:r})}))}},{key:"render",value:function(){var e=this;return Object(v.jsx)(b.a,{children:Object(v.jsx)(N.b,{ReactRouterRoute:_.a,children:Object(v.jsxs)("div",{className:"App",children:[Object(v.jsx)("div",{className:"header",children:Object(v.jsx)(b.b,{to:"/",children:Object(v.jsx)("img",{src:V,alt:"logo"})})}),Object(v.jsx)("div",{className:"app-content",children:Object(v.jsxs)(_.c,{children:[Object(v.jsx)(_.a,{exact:!0,path:"/resource/:resourceId",render:function(e){return Object(v.jsx)(A,{resourceId:e.match.params.resourceId})}}),Object(v.jsx)(_.a,{path:"/",render:function(t){var r=D.a.parse(t.location.search.slice(1));return Object(v.jsx)(M,{archiveItems:e.state.archiveItems,filters:e.state,params:r})}})]})})]})})})}}]),r}(s.Component),H=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,277)).then((function(t){var r=t.getCLS,s=t.getFID,i=t.getFCP,a=t.getLCP,c=t.getTTFB;r(e),s(e),i(e),a(e),c(e)}))};r(269);c.a.render(Object(v.jsx)(i.a.StrictMode,{children:Object(v.jsx)(E,{})}),document.getElementById("root")),H()}},[[270,1,2]]]);
//# sourceMappingURL=main.65bb2268.chunk.js.map