(this["webpackJsonpische-pandemic-archive"]=this["webpackJsonpische-pandemic-archive"]||[]).push([[0],{113:function(e,t,r){},114:function(e,t,r){},115:function(e,t,r){},121:function(e,t,r){},184:function(e,t){},185:function(e,t){},261:function(e,t,r){},265:function(e,t,r){"use strict";r.r(t);var s=r(0),i=r.n(s),a=r(105),c=r.n(a),n=(r(113),r(12)),o=r(13),l=r(15),u=r(14),d=(r(114),r(115),r(267)),h=r(268),j=r(269),p=r(270),m=r(271),f=r(266),b=r(28),v=r(1),O=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(o.a)(r,[{key:"render",value:function(){return Object(v.jsx)(b.c,{to:"/resource/"+this.props.item.id,children:Object(v.jsxs)(m.a,{style:{marginBottom:"10px",minHeight:"280px"},children:[this.props.item.fields.Attachments&&this.props.item.fields.Attachments.length>0&&Object(v.jsx)(m.a.Img,{variant:"top",src:this.props.item.fields.Attachments[0].url}),Object(v.jsxs)(m.a.Body,{children:[Object(v.jsx)(m.a.Title,{children:this.props.item.fields["Title ID"]}),Object(v.jsx)(m.a.Text,{}),this.props.item.fields.Type_name&&this.props.item.fields.Type_name.map((function(e){return Object(v.jsx)(f.a,{variant:"info",children:e})}))]})]})})}}]),r}(s.Component),x=(r(121),r(108)),y=r(27),g=function(e){var t=Object(y.c)(e.filterName,y.a),r=Object(x.a)(t,2),s=r[0],i=r[1],a=s||[];return Object(v.jsxs)("div",{children:[Object(v.jsx)("div",{className:"filter-title",children:e.blockTitle}),Object(v.jsx)("ul",{children:e.filterItems.map((function(t){var r=t.fields[e.labelBy];return Object(v.jsx)("li",{children:Object(v.jsxs)("label",{children:[Object(v.jsx)("input",{type:"checkbox",checked:a.includes(r),value:r,onChange:function(){return e=r,a.includes(e)?a.splice(a.indexOf(e),1):a.push(e),void i(a);var e}}),r," (",t.fields.Count,")"]})})}))})]})},w=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(o.a)(r,[{key:"render",value:function(){return Object(v.jsxs)("div",{className:"sidebar-container",children:[Object(v.jsx)("div",{className:"filter-type",children:Object(v.jsx)(g,{blockTitle:"Resource Type",filterName:"Type",labelBy:"Type",filterItems:this.props.filters.types})}),Object(v.jsx)("div",{className:"filter-type",children:Object(v.jsx)(g,{blockTitle:"Tags",filterName:"Tags",labelBy:"Tag",filterItems:this.props.filters.tags})})]})}}]),r}(s.Component),k=r(22),N=r.n(k),T=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(n.a)(this,r);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).state={archiveItems:[],loading:!1},e}return Object(o.a)(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e){JSON.stringify(e.params)!==JSON.stringify(this.props.params)&&this.fetchData()}},{key:"fetchData",value:function(){var e=this,t=this;t.setState({loading:!0});var r=new N.a({apiKey:"key8p1ipk3FEGppuA"}).base("appyRkLfkVtG84rMU"),s=[];this.props.params&&Object.keys(this.props.params).forEach((function(t){var r=Array.isArray(e.props.params[t])?e.props.params[t]:[e.props.params[t]];s.push("OR("+r.map((function(e){return"{"+t+'}="'+e+'"'})).join(", ")+")")}));var i=s.length>0?"AND("+s.join(", ")+")":"";r("Data Sample").select({view:"Grid view",filterByFormula:i}).firstPage((function(e,r){e?console.error(e):t.setState({archiveItems:r,loading:!1})}))}},{key:"render",value:function(){return Object(v.jsxs)("div",{className:"home-view",children:[Object(v.jsx)("div",{className:"sidebar",children:Object(v.jsx)(w,{filters:this.props.filters})}),Object(v.jsx)("div",{className:"main-content",children:this.state.loading?Object(v.jsxs)("div",{className:"loading",children:[Object(v.jsx)(d.a,{animation:"border"}),"Loading resources"]}):Object(v.jsx)(h.a,{children:Object(v.jsx)(j.a,{xs:2,md:3,lg:4,children:this.state.archiveItems.map((function(e){return Object(v.jsx)(p.a,{children:Object(v.jsx)(O,{item:e})},e.id)}))})})})]})}}]),r}(s.Component);r(261);var I=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(n.a)(this,r);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).state={resource:{}},e}return Object(o.a)(r,[{key:"componentDidMount",value:function(){var e=this;new N.a({apiKey:"key8p1ipk3FEGppuA"}).base("appyRkLfkVtG84rMU")("Data Sample").find(this.props.resourceId,(function(t,r){t?console.error(t):e.setState({resource:r})}))}},{key:"generateEmbedCode",value:function(){var e,t,r=Object(v.jsx)("div",{});try{e=new URL(this.state.resource.fields.URL)}catch(n){r=Object(v.jsx)("div",{children:"No url is defined"})}if(e)if(e.hostname.includes("youtu")){var s=(t=(t=e.href).replace(/(>|<)/gi,"").split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]?t[2].split(/[^0-9a-z_\-]/i)[0]:t;r=Object(v.jsx)("iframe",{width:"640",height:"360",title:"content",src:"https://www.youtube.com/embed/"+s,frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0})}else if(e.hostname.includes("vimeo")){var i=function(e){var t="",r=e.match(/https:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/);return r&&(t=r[2]),t}(e.href);r=Object(v.jsx)("iframe",{width:"640",height:"360",title:"content",src:"https://player.vimeo.com/video/"+i,frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:!0})}else if(e.hostname.includes("archive.org")){var a=function(e){return e.replace("details","embed")}(e.href);r=Object(v.jsx)("iframe",{width:"640",height:"360",title:"content",src:a,frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:!0})}else if(e.hostname.includes("spotify")){var c=function(e){var t=new URL(e);return t.origin+"/embed/"+t.pathname}(e.href);r=Object(v.jsx)("iframe",{width:"640",height:"360",title:"content",src:c,frameborder:"0",allowtransparency:"true",allow:"encrypted-media"})}else e.hostname.includes("soundcloud")&&(r=Object(v.jsx)("div",{children:"Soundcloud - work in progress"}));return r}},{key:"resourceMedia",value:function(){var e=Object(v.jsx)("span",{children:"No item format defined"}),t=this.state.resource.fields.item_format;return"Website"===t||"Image"===t?e=Object(v.jsx)("img",{src:this.state.resource.fields.Attachments[0].url,alt:this.state.resource.fields["Title ID"]}):"Embed"===t&&(e=this.generateEmbedCode()),e}},{key:"resourceInfo",value:function(){var e=this;return Object(v.jsxs)("div",{className:"resource-sideinfo",children:[Object(v.jsxs)("div",{className:"resource-title",children:[this.state.resource.fields["Title ID"],Object(v.jsx)("div",{className:"bookmark"})]}),Object(v.jsx)("div",{className:"resource-desc",children:this.state.resource.fields["Summary (limit 500)"]}),Object(v.jsx)("div",{className:"resource-metadata",children:["Pandemics","Type_name","Themes_name","Tags","Country","City","Language","Credits","Created","Published","Archived","Contributor"].map((function(t){return Object(v.jsxs)("div",{className:"meta-row",children:[Object(v.jsx)("div",{className:"meta-title",children:t}),Object(v.jsx)("div",{className:"meta-value",children:Array.isArray(e.state.resource.fields[t])?e.state.resource.fields[t].join(", "):e.state.resource.fields[t]})]},t)}))}),this.state.resource.fields.URL&&Object(v.jsx)("div",{className:"resource-source",children:Object(v.jsx)("a",{href:this.state.resource.fields.URL,children:"GO TO THE SOURCE"})})]})}},{key:"render",value:function(){return this.state.resource.fields?Object(v.jsxs)("div",{className:"resource-view",children:[Object(v.jsx)("div",{className:"resource-preview",children:this.resourceMedia()}),Object(v.jsx)("div",{className:"resource-sideinfo-container",children:this.resourceInfo()})]}):Object(v.jsxs)("div",{className:"loading",children:[Object(v.jsx)(d.a,{animation:"border"}),"Loading resource"]})}}]),r}(s.Component),C=r(107),A=r.n(C),S=r.p+"static/media/logo.65b2bc4b.svg",L=r(3),D=function(e){Object(l.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(n.a)(this,r);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).state={types:[],pandemics:[],languages:[],tags:[],countries:[]},e}return Object(o.a)(r,[{key:"componentDidMount",value:function(){var e=this,t=new N.a({apiKey:"key8p1ipk3FEGppuA"}).base("appyRkLfkVtG84rMU");t("Type list").select({view:"Grid view"}).firstPage((function(t,r){t?console.error(t):e.setState({types:r})})),t("Pandemic list").select({view:"Grid view"}).firstPage((function(t,r){t?console.error(t):e.setState({pandemics:r})})),t("Language list").select({view:"Grid view"}).firstPage((function(t,r){t?console.error(t):e.setState({languages:r})})),t("Tag list").select({view:"Grid view"}).firstPage((function(t,r){t?console.error(t):e.setState({tags:r})})),t("Countries List").select({view:"Grid view"}).firstPage((function(t,r){t?console.error(t):e.setState({countries:r})}))}},{key:"render",value:function(){var e=this;return Object(v.jsx)(b.a,{children:Object(v.jsx)(y.b,{ReactRouterRoute:L.a,children:Object(v.jsxs)("div",{className:"App",children:[Object(v.jsx)("div",{className:"header",children:Object(v.jsx)(b.b,{to:"/",children:Object(v.jsx)("img",{src:S,alt:"logo"})})}),Object(v.jsx)("div",{className:"app-content",children:Object(v.jsxs)(L.c,{children:[Object(v.jsx)(L.a,{exact:!0,path:"/resource/:resourceId",render:function(e){return Object(v.jsx)(I,{resourceId:e.match.params.resourceId})}}),Object(v.jsx)(L.a,{path:"/",render:function(t){var r=A.a.parse(t.location.search.slice(1));return Object(v.jsx)(T,{archiveItems:e.state.archiveItems,filters:e.state,params:r})}})]})})]})})})}}]),r}(s.Component),R=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,272)).then((function(t){var r=t.getCLS,s=t.getFID,i=t.getFCP,a=t.getLCP,c=t.getTTFB;r(e),s(e),i(e),a(e),c(e)}))};r(264);c.a.render(Object(v.jsx)(i.a.StrictMode,{children:Object(v.jsx)(D,{})}),document.getElementById("root")),R()}},[[265,1,2]]]);
//# sourceMappingURL=main.36ce66cc.chunk.js.map